<% layout('/layouts/boilerplate') %>
<link rel="stylesheet" href="/style/reports-sales.css">

<div class="sales-main">
  <div class="print-header">
  <div class="shop-name"><%= shopName %> </div>
  </div>
  <div class="sales-header">
    <h2>Sales Report</h2>
    <div class="header-actions">
      <div class="print-meta">
    Period: <%= from %> to <%= to %><br>
    Generated on: <%= new Date().toLocaleString() %>
  </div>
      <div class="button-group">
        <button type="button" onclick="window.print()" class="print-btn">
          Print
        </button>
      </div>
    </div>
  </div>

  <!-- Filter Bar -->
  <form method="GET" class="filter-bar">
    <input type="date" name="from" value="<%= from %>" required>
    <span class="to-text">to</span>
    <input type="date" name="to" value="<%= to %>" required>
    <button type="submit">Generate</button>
  </form>

  <!-- Summary Cards -->
  <% if (summary) { %>
    <div class="summary">
      <div class="card">
        <div class="label">Total Bills</div>
        <div class="value"><%= summary.total_bills %></div>
      </div>

      <div class="card highlight">
        <div class="label">Total Sales</div>
        <div class="value">₹ <%= summary.total_sales %></div>
      </div>

      <div class="card">
        <div class="label">Total GST</div>
        <div class="value">₹ <%= summary.total_gst %></div>
      </div>
    </div>
  <% } %>

  <!-- Sales Table -->
  <% if (bills && bills.length) { %>
    <table class="report-table">
      <thead>
        <tr>
          <th>Date</th>
          <th>Invoice No</th>
          <th>Type</th>
          <th>Customer</th>
          <th>Total</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody>
        <% bills.forEach(b => { %>
          <tr style="cursor: pointer;" onclick="window.location.href='/bills/<%= b.id %>'">
            <td><%= b.bill_date %></td>
            <td class="invoice">
              <%= b.invoice_no %>
            </td>
            <td>
              <span class="badge <%= b.bill_type %>">
                <%= b.bill_type.replace('_', ' ') %>
              </span>
            </td>
            <td><%= b.customer_name %></td>
            <td>₹ <%= b.grand_total %></td>
            <td>View</td>
          </tr>
        <% }) %>
      </tbody>
    </table>
  <% } %>
</div>
