<% layout('/layouts/boilerplate') %>
<link rel="stylesheet" href="/style/billing.css">

<div class="billing">

  <!-- ===== Header ===== -->
  <div class="billing-header">
    <div>
      <h1>Billing</h1>
      <span>All invoices & payment status</span>
    </div>

    <a href="/bills/new">
      <button class="create">+ Create Invoice</button>
    </a>
  </div>

  <!-- ===== Table ===== -->
  <div class="billing-box">
    <table class="billing-table">
      <thead>
        <tr>
          <th>Invoice</th>
          <th>Customer</th>
          <th>Date</th>
          <th>Amount</th>
          <th>Status</th>
          <th>Action</th>
        </tr>
      </thead>

      <tbody>
        <% if (!bills.length) { %>
          <tr>
            <td colspan="5" class="empty">No invoices found</td>
          </tr>
        <% } %>

        <% bills.forEach(bill => { %>
          <tr style="cursor: pointer;" onclick="window.location.href='/bills/<%= bill.id %>'">
            <td style="font-weight:500;">
              <%= bill.invoice_no %>
            </td>

            <td><%= bill.customer_name %></td>

            <td>
              <%= new Date(bill.created_at).toLocaleDateString('en-IN') %>
            </td>

            <td style="font-weight:500;">
              â‚¹<%= bill.grand_total %>
            </td>

            <td>
              <% if (bill.status === "CANCELLED") { %>
                <span class="badge pending">Cancelled</span>
              <% } else if (bill.payment_status === "PAID") { %>
                <span class="badge paid">Paid</span>
              <% } else if (bill.payment_status === "PARTIAL") { %>
                <span class="badge partial">Partial</span>
              <% } else { %>
                <span class="badge pending">Due</span>
              <% } %>
            </td>

            <td>View</td>
          </tr>
        <% }) %>
      </tbody>
    </table>
  </div>

</div>
